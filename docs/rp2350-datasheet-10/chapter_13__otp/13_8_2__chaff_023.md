---
source_pdf: rp2350-datasheet-10.pdf
repository: llm_database
chapter: Chapter 13. OTP
section: 13.8.2. Chaff
pages: 1281-1281
type: technical_spec
generated_at: 2026-03-01T12:20:14.494106+00:00
---

# 13.8.2. Chaff

13.8.2. Chaff

OTP bits come in pairs: two bits are stored in the isolated gates of two transistors, with a common bit line between

them. This structure is known as a bit cell. In each 64-row OTP page, rows i and 32 + i share the same bit cells. For

example, the ECC halfwords BOOTKEY0_0 and BOOTKEY2_0 are physically colocated.

The particulars of the PVC technique make it difficult to distinguish which of the two bits in a bit cell is set. If one bit in

each pair is known to be zero — for example, a key stored at the bottom of an otherwise blank page — then the data can

be trivially read from the PVC image. However the presence of unknown data in both bits frustrates these attempts.

This fact can be exploited by storing data redundantly in the top and bottom half of each page. Specifically:

• Store arbitrary data in each row i from 0 to 31.
• Store the 24-bit bitwise complement of those values in each row 32 + i.

The bitwise operations specified here are on the entire 24-bit raw row contents, including the ECC bit pattern.

An alternative technique is to store a random value in row 32 + i and the XOR of that random value with the desired data

value in row i. This is advantageous from a power side channel perspective because it avoids reading the secret value

directly from OTP, and the example RP2350 encrypted bootloader uses a similar technique with a 4-way XOR. However

the bitwise complement technique described above is recommended for pairwise chaff. This is the same as the XOR

technique with a fixed XOR pattern of 0xffffff.
